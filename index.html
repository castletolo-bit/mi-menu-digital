<!DOCTYPE html>
<html lang="es"> 
  <head> 
    <meta charset="UTF-8"> 
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
    <title>La Gusguer√≠a - Men√∫ Digital</title> 
    <script src="https://cdn.tailwindcss.com"></script> 
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;900&display=swap" rel="stylesheet"> 
    <style> body { font-family: 'Montserrat', sans-serif; } .product-card { transition: all 0.2s ease-in-out; } .product-card:active { transform: scale(0.96); } .img-container { position: relative; overflow: hidden; } .img-container img { transition: transform 0.5s; } @keyframes bounce { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.15); } } .animate-bump { animation: bounce 0.3s ease-in-out; } 
    </style> 
  </head> 
  <body class="bg-gray-50 pb-32"> 
    <header class="bg-gradient-to-br from-orange-600 to-red-700 text-white p-8 text-center shadow-2xl rounded-b-[3rem] sticky top-0 z-40"> 
      <h1 class="text-4xl font-black uppercase">La Gusguer√≠a</h1> 
      <p class="text-sm opacity-90 mt-2 italic font-bold">PARA APAGAR LA SED DE LA MALA</p> 
    </header>
    <main id="menu-container" class="p-4 max-w-lg mx-auto space-y-4 mt-4">
      <div class="text-center py-20"><p>Cargando el men√∫...</p></div>
    </main>
    <nav class="fixed bottom-0 left-0 right-0 bg-white/90 backdrop-blur-md p-5 shadow-2xl border-t flex justify-between items-center z-50 rounded-t-3xl max-w-2xl mx-auto">
        <div class="flex flex-col">
            <span class="text-gray-400 text-[10px] uppercase font-black">Total</span>
            <span id="total-display" class="text-3xl font-black text-gray-900">$0.00</span>
        </div>
        <button onclick="enviarWhatsApp()" class="bg-green-600 text-white px-8 py-4 rounded-2xl font-black uppercase text-sm">Pedir por WhatsApp</button>
    </nav>

<script>
    const SHEET_CSV_URL = '[https://docs.google.com/spreadsheets/d/e/2PACX-1vT1TiLuDQq5Dk3vJjhmd534zHWNeHu4v-UAnDcfZxMpFaTNAzn-hy5Wmn8O1IqYvNUiMF7qbGfGLSBR/pub?gid=1374506693&single=true&output=csv](https://docs.google.com/spreadsheets/d/e/2PACX-1vT1TiLuDQq5Dk3vJjhmd534zHWNeHu4v-UAnDcfZxMpFaTNAzn-hy5Wmn8O1IqYvNUiMF7qbGfGLSBR/pub?gid=1374506693&single=true&output=csv)'; 
    const SECURITY_HASH = "NTIxNTYzOTQ3NTQ3OA=="; 
    let carrito = []; let total = 0;
    const _extract = (h) => atob(h);

    async function cargarMenu() {
        try {
            const response = await fetch(SHEET_CSV_URL + '&t=' + Date.now());
            const csvData = await response.text();
            const filas = csvData.split('\n').slice(1);
            const container = document.getElementById('menu-container');
            container.innerHTML = "";
            filas.forEach(fila => {
                const col = fila.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/).map(c => c.replace(/"/g, '').trim());
                if (col.length < 6) return;
                const isAgotado = col[5] && col[5].toLowerCase() === 'agotado';
                const precio = parseFloat(col[4]) || 0;
                const img = col[6] || "[https://via.placeholder.com/300?text=Antojo](https://via.placeholder.com/300?text=Antojo)";
                container.innerHTML += `
                    <div class="product-card p-3 rounded-[2rem] bg-white border flex gap-4 ${isAgotado ? 'opacity-50 grayscale' : 'shadow-md'}">
                        <div class="w-24 h-24 flex-shrink-0 overflow-hidden rounded-2xl bg-gray-100">
                            <img src="${img}" class="w-full h-full object-cover" onerror="this.src='[https://via.placeholder.com/300?text=La+Gusgueria](https://via.placeholder.com/300?text=La+Gusgueria)'">
                        </div>
                        <div class="flex-1 flex flex-col justify-between">
                            <div><h3 class="font-bold text-gray-800">${col[2]}</h3><p class="text-[10px] text-gray-400">${col[3]}</p></div>
                            <div class="flex justify-between items-center"><span class="font-black">$${precio.toFixed(2)}</span>
                            ${isAgotado ? '' : `<button onclick="agregar('${col[2].replace(/'/g,"")}',${precio})" class="bg-orange-100 text-orange-600 w-10 h-10 rounded-xl font-bold">+</button>`}</div>
                        </div>
                    </div>`;
            });
        } catch (e) { console.error(e); }
    }

    function agregar(n, p) {
        carrito.push({n, p}); total += p;
        const d = document.getElementById('total-display');
        d.innerText = '$' + total.toFixed(2);
        d.classList.add('animate-bump'); setTimeout(() => d.classList.remove('animate-bump'), 300);
    }

    function enviarWhatsApp() {
        if (carrito.length === 0) return alert("¬°Carrito vac√≠o!");
        let m = `*üìù PEDIDO - LA GUSGUER√çA*\n`;
        carrito.forEach(i => m += `‚ñ™Ô∏è ${i.n} .. $${i.p.toFixed(2)}\n`);
        m += `*TOTAL: $${total.toFixed(2)}*`;
        window.open(`https://wa.me/${_extract(SECURITY_HASH)}?text=${encodeURIComponent(m)}`, "_top");
    }
    cargarMenu();
</script>
</body> 
</html>
